angular.module("ngReddit",["ngResource","ngRoute"]).config(["$routeProvider","$locationProvider",function(t,o){t.when("/",{templateUrl:"views/home.html",controller:"homeCtrl",resolve:{posts:["_posts",function(t){return t.query()}]}}).when("/posts/:id",{templateUrl:"views/post.html",controller:"postCtrl",resolve:{post:["$route","_posts",function(t,o){return o.get({id:t.current.params.id})}]}}).when("/submit/:type",{templateUrl:"views/submit.html",controller:"submitCtrl"}).when("/signup",{templateUrl:"views/signup.html",controller:"signupCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"loginCtrl"}).otherwise({redirectTo:"/"}),o.html5Mode(!0)}]).config(["$httpProvider",function(t){t.interceptors.push(["$q","$rootScope",function(t,o){function e(e){return o.errors.push(e.data),t.reject(e)}return{requestError:e,responseError:e}}])}]),angular.module("ngReddit").controller("mainCtrl",["$rootScope","$scope","$http",function(t,o,e){t.errors=[],e.get("/api/authcheck").success(function(o){t.user=o}),o.logout=function(){e.get("/api/logout").success(function(){t.user=null})}}]).controller("homeCtrl",["$scope","$http","_posts","_remove","_vote","posts",function(t,o,e,n,r,s){t.newPost={},t.posts=s,t.addPost=function(){return t.newPost.title?void e.save(t.newPost,function(o){t.posts.push(o),t.newPost={}}):!1},t.vote=function(t,o){var e="/api/posts/"+o._id+"/vote/"+t;r(t,o,e)},t["delete"]=function(o){e["delete"]({id:o._id},function(){n(t.posts,o)})}}]).controller("postCtrl",["$scope","$http","_comments","_remove","_vote","post",function(t,o,e,n,r,s){t.post=s,t.newComment={body:"",post:t.post._id},t.addComment=function(){t.newComment.body&&e.save({postId:s._id},t.newComment,function(o){s.comments.push(o),t.newComment.body=""})},t.vote=function(t,o){var e="/api/posts/"+o._id+"/vote/"+t;r(t,o,e)},t.voteComment=function(t,o){var e="/api/posts/"+s._id+"/comments/"+o._id+"/vote/"+t;r(t,o,e)}}]).controller("submitCtrl",["$scope","$routeParams",function(t,o){t.type=o.type}]).controller("signupCtrl",["$rootScope","$scope","$http","$location",function(t,o,e,n){return t.user?n.path("/"):(o.newUser={},void(o.signup=function(){return o.newUser.password!==o.newUser.confirmPassword?!1:void e.post("/api/signup",o.newUser).success(function(o){t.user=o,n.path("/")})}))}]).controller("loginCtrl",["$rootScope","$scope","$http","$location",function(t,o,e,n){return t.user?n.path("/"):(o.loggedUser={},void(o.login=function(){e.post("/api/login",o.loggedUser).success(function(o){t.user=o,n.path("/")})}))}]),angular.module("ngReddit").factory("_posts",["$resource",function(t){return t("/api/posts/:id")}]).factory("_comments",["$resource",function(t){return t("/api/posts/:postId/comments/:id/:vote",{id:"@id",postId:"@postId",vote:"@vote"},{update:{method:"PUT"}})}]).factory("_authUser",["$resource",function(t){return t("/api/authcheck")}]).factory("_remove",function(){return function(t,o){var e=t.indexOf(o);return e>-1?t.splice(e,1):void 0}}).factory("_vote",["$http","$rootScope","_remove",function(t,o,e){return function(n,r,s){t.put(s).success(function(){if(o.user){var t=n>0?"upvoted":"downvoted",s=o.user.username;~r[t].indexOf(s)?e(r[t],s):r[t].push(s),e(r[0>n?"upvoted":"downvoted"],s)}})}}]),angular.module("ngReddit").filter("pluralize",function(){return function(t){var o=""+parseInt(t),e=o.slice(-1);return t.replace(/\(([^)]+)\)/,function(t){return t=t.slice(1,-1).split(","),1==o.slice(-2,-1)||e>4||"0"===e?t[2]:1==e?t[0]:t[1]})}});